{
    "version": 1,
    "serial": 22,
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {},
            "resources": {
                "aws_instance.vyos01": {
                    "type": "aws_instance",
                    "primary": {
                        "id": "i-357b8ebf",
                        "attributes": {
                            "ami": "ami-5e77c229",
                            "associate_public_ip_address": "true",
                            "availability_zone": "eu-west-1b",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "",
                            "id": "i-357b8ebf",
                            "instance_state": "running",
                            "instance_type": "t2.micro",
                            "key_name": "przchrome",
                            "monitoring": "false",
                            "private_dns": "",
                            "private_ip": "10.50.11.115",
                            "public_dns": "",
                            "public_ip": "54.194.218.3",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "0",
                            "root_block_device.0.volume_size": "4",
                            "root_block_device.0.volume_type": "standard",
                            "security_groups.#": "0",
                            "source_dest_check": "true",
                            "subnet_id": "subnet-bae4b7d3",
                            "tags.#": "3",
                            "tags.Name": "test-vyos-1.1.0-i01",
                            "tags.environment": "prz",
                            "tags.project": "prz",
                            "tenancy": "default",
                            "vpc_security_group_ids.#": "1",
                            "vpc_security_group_ids.2936417429": "sg-ee6b7782"
                        },
                        "meta": {
                            "schema_version": "1"
                        }
                    }
                },
                "aws_instance.vyos02": {
                    "type": "aws_instance",
                    "primary": {
                        "id": "i-5e7b8ed4",
                        "attributes": {
                            "ami": "ami-5e77c229",
                            "associate_public_ip_address": "true",
                            "availability_zone": "eu-west-1b",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "",
                            "id": "i-5e7b8ed4",
                            "instance_state": "running",
                            "instance_type": "t2.micro",
                            "key_name": "przchrome",
                            "monitoring": "false",
                            "private_dns": "",
                            "private_ip": "10.50.11.42",
                            "public_dns": "",
                            "public_ip": "54.194.158.243",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "0",
                            "root_block_device.0.volume_size": "4",
                            "root_block_device.0.volume_type": "standard",
                            "security_groups.#": "0",
                            "source_dest_check": "true",
                            "subnet_id": "subnet-bae4b7d3",
                            "tags.#": "3",
                            "tags.Name": "test-vyos-1.1.0-i02",
                            "tags.environment": "prz",
                            "tags.project": "prz",
                            "tenancy": "default",
                            "vpc_security_group_ids.#": "1",
                            "vpc_security_group_ids.2936417429": "sg-ee6b7782"
                        },
                        "meta": {
                            "schema_version": "1"
                        }
                    }
                },
                "null_resource.provision_vyos01": {
                    "type": "null_resource",
                    "depends_on": [
                        "aws_instance.vyos01",
                        "aws_instance.vyos01",
                        "aws_instance.vyos01",
                        "aws_instance.vyos01",
                        "aws_instance.vyos01",
                        "template_file.001_base_configuration_vyos01",
                        "template_file.010_ipsec_configuration_vyos01"
                    ],
                    "primary": null,
                    "tainted": [
                        {
                            "id": "1990008197573607610",
                            "attributes": {
                                "id": "1990008197573607610",
                                "triggers.#": "1",
                                "triggers.instance_id": "i-357b8ebf"
                            }
                        }
                    ]
                },
                "null_resource.provision_vyos02": {
                    "type": "null_resource",
                    "depends_on": [
                        "aws_instance.vyos02",
                        "aws_instance.vyos02",
                        "aws_instance.vyos02",
                        "aws_instance.vyos02",
                        "aws_instance.vyos02",
                        "template_file.001_base_configuration_vyos02",
                        "template_file.010_ipsec_configuration_vyos02"
                    ],
                    "primary": null,
                    "tainted": [
                        {
                            "id": "8066651699372878236",
                            "attributes": {
                                "id": "8066651699372878236",
                                "triggers.#": "1",
                                "triggers.instance_id": "i-5e7b8ed4"
                            }
                        }
                    ]
                },
                "template_file.001_base_configuration_vyos01": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_instance.vyos01",
                        "aws_instance.vyos02"
                    ],
                    "primary": {
                        "id": "04cd8b3292f8805c943d7976f5057efd4847bec0b83f7286eb0fe8c7d75af11b",
                        "attributes": {
                            "id": "04cd8b3292f8805c943d7976f5057efd4847bec0b83f7286eb0fe8c7d75af11b",
                            "rendered": "#!/bin/vbash\n\nsource /opt/vyatta/etc/functions/script-template\n\nconfigure\nset system host-name vyos01\n\nset 'firewall' 'all-ping' 'enable'\nset 'firewall' 'broadcast-ping' 'disable'\nset 'firewall' 'config-trap' 'disable'\n\nset 'firewall' 'group' 'address-group' 'Peers' 'address' \"10.50.11.115\"\nset 'firewall' 'group' 'address-group' 'Peers' 'address' \"10.50.11.42\"\n\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '10.0.0.0/8'\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '172.16.0.0/12'\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '192.168.0.0/16'\n\nset 'firewall' 'ipv6-receive-redirects' 'disable'\nset 'firewall' 'ipv6-src-route' 'disable'\nset 'firewall' 'ip-src-route' 'disable'\nset 'firewall' 'log-martians' 'disable'\n\nset 'firewall' 'receive-redirects' 'disable'\nset 'firewall' 'send-redirects' 'enable'\nset 'firewall' 'source-validation' 'disable'\nset 'firewall' 'syn-cookies' 'enable'\nset 'firewall' 'twa-hazards-protection' 'disable'\n\nset 'service' 'snmp' 'community' 'public' 'authorization' 'ro'\nset 'service' 'snmp' 'community' 'public' 'client' \"10.50.11.115\"\nset 'service' 'snmp' 'community' 'public' 'client' \"10.50.11.42\"\nset 'service' 'snmp' 'contact' 'Here are the Dragons \u003cdragons@wherever.com\u003e'\nset 'service' 'snmp' 'location' 'The Cave'\n\nset 'service' 'ssh' 'port' '22'\n\nset 'system' 'name-server' '8.8.8.8'\nset 'system' 'name-server' '8.8.4.4'\n\nset 'system' 'ntp' 'server' '0.pool.ntp.org'\nset 'system' 'ntp' 'server' '1.pool.ntp.org'\nset 'system' 'ntp' 'server' '2.pool.ntp.org'\n\nset 'system' 'time-zone' 'UTC'\n\ncommit\n\n",
                            "template": "#!/bin/vbash\n\nsource /opt/vyatta/etc/functions/script-template\n\nconfigure\nset system host-name ${short_name}\n\nset 'firewall' 'all-ping' 'enable'\nset 'firewall' 'broadcast-ping' 'disable'\nset 'firewall' 'config-trap' 'disable'\n\nset 'firewall' 'group' 'address-group' 'Peers' 'address' \"${private_ip_mine}\"\nset 'firewall' 'group' 'address-group' 'Peers' 'address' \"${private_ip_peer}\"\n\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '10.0.0.0/8'\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '172.16.0.0/12'\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '192.168.0.0/16'\n\nset 'firewall' 'ipv6-receive-redirects' 'disable'\nset 'firewall' 'ipv6-src-route' 'disable'\nset 'firewall' 'ip-src-route' 'disable'\nset 'firewall' 'log-martians' 'disable'\n\nset 'firewall' 'receive-redirects' 'disable'\nset 'firewall' 'send-redirects' 'enable'\nset 'firewall' 'source-validation' 'disable'\nset 'firewall' 'syn-cookies' 'enable'\nset 'firewall' 'twa-hazards-protection' 'disable'\n\nset 'service' 'snmp' 'community' 'public' 'authorization' 'ro'\nset 'service' 'snmp' 'community' 'public' 'client' \"${private_ip_mine}\"\nset 'service' 'snmp' 'community' 'public' 'client' \"${private_ip_peer}\"\nset 'service' 'snmp' 'contact' 'Here are the Dragons \u003cdragons@wherever.com\u003e'\nset 'service' 'snmp' 'location' 'The Cave'\n\nset 'service' 'ssh' 'port' '22'\n\nset 'system' 'name-server' '8.8.8.8'\nset 'system' 'name-server' '8.8.4.4'\n\nset 'system' 'ntp' 'server' '0.pool.ntp.org'\nset 'system' 'ntp' 'server' '1.pool.ntp.org'\nset 'system' 'ntp' 'server' '2.pool.ntp.org'\n\nset 'system' 'time-zone' 'UTC'\n\ncommit\n\n",
                            "vars.#": "4",
                            "vars.fqdn": "test-vyos-1.1.0-i01",
                            "vars.private_ip_mine": "10.50.11.115",
                            "vars.private_ip_peer": "10.50.11.42",
                            "vars.short_name": "vyos01"
                        }
                    }
                },
                "template_file.001_base_configuration_vyos02": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_instance.vyos01",
                        "aws_instance.vyos02"
                    ],
                    "primary": {
                        "id": "12cd35156e5f834c6fa353f6286c0e7e39a493347a8a30445c440fd49dfb8a4b",
                        "attributes": {
                            "id": "12cd35156e5f834c6fa353f6286c0e7e39a493347a8a30445c440fd49dfb8a4b",
                            "rendered": "#!/bin/vbash\n\nsource /opt/vyatta/etc/functions/script-template\n\nconfigure\nset system host-name vyos02\n\nset 'firewall' 'all-ping' 'enable'\nset 'firewall' 'broadcast-ping' 'disable'\nset 'firewall' 'config-trap' 'disable'\n\nset 'firewall' 'group' 'address-group' 'Peers' 'address' \"10.50.11.42\"\nset 'firewall' 'group' 'address-group' 'Peers' 'address' \"10.50.11.115\"\n\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '10.0.0.0/8'\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '172.16.0.0/12'\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '192.168.0.0/16'\n\nset 'firewall' 'ipv6-receive-redirects' 'disable'\nset 'firewall' 'ipv6-src-route' 'disable'\nset 'firewall' 'ip-src-route' 'disable'\nset 'firewall' 'log-martians' 'disable'\n\nset 'firewall' 'receive-redirects' 'disable'\nset 'firewall' 'send-redirects' 'enable'\nset 'firewall' 'source-validation' 'disable'\nset 'firewall' 'syn-cookies' 'enable'\nset 'firewall' 'twa-hazards-protection' 'disable'\n\nset 'service' 'snmp' 'community' 'public' 'authorization' 'ro'\nset 'service' 'snmp' 'community' 'public' 'client' \"10.50.11.42\"\nset 'service' 'snmp' 'community' 'public' 'client' \"10.50.11.115\"\nset 'service' 'snmp' 'contact' 'Here are the Dragons \u003cdragons@wherever.com\u003e'\nset 'service' 'snmp' 'location' 'The Cave'\n\nset 'service' 'ssh' 'port' '22'\n\nset 'system' 'name-server' '8.8.8.8'\nset 'system' 'name-server' '8.8.4.4'\n\nset 'system' 'ntp' 'server' '0.pool.ntp.org'\nset 'system' 'ntp' 'server' '1.pool.ntp.org'\nset 'system' 'ntp' 'server' '2.pool.ntp.org'\n\nset 'system' 'time-zone' 'UTC'\n\ncommit\n\n",
                            "template": "#!/bin/vbash\n\nsource /opt/vyatta/etc/functions/script-template\n\nconfigure\nset system host-name ${short_name}\n\nset 'firewall' 'all-ping' 'enable'\nset 'firewall' 'broadcast-ping' 'disable'\nset 'firewall' 'config-trap' 'disable'\n\nset 'firewall' 'group' 'address-group' 'Peers' 'address' \"${private_ip_mine}\"\nset 'firewall' 'group' 'address-group' 'Peers' 'address' \"${private_ip_peer}\"\n\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '10.0.0.0/8'\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '172.16.0.0/12'\nset 'firewall' 'group' 'network-group' 'RFC1918' 'network' '192.168.0.0/16'\n\nset 'firewall' 'ipv6-receive-redirects' 'disable'\nset 'firewall' 'ipv6-src-route' 'disable'\nset 'firewall' 'ip-src-route' 'disable'\nset 'firewall' 'log-martians' 'disable'\n\nset 'firewall' 'receive-redirects' 'disable'\nset 'firewall' 'send-redirects' 'enable'\nset 'firewall' 'source-validation' 'disable'\nset 'firewall' 'syn-cookies' 'enable'\nset 'firewall' 'twa-hazards-protection' 'disable'\n\nset 'service' 'snmp' 'community' 'public' 'authorization' 'ro'\nset 'service' 'snmp' 'community' 'public' 'client' \"${private_ip_mine}\"\nset 'service' 'snmp' 'community' 'public' 'client' \"${private_ip_peer}\"\nset 'service' 'snmp' 'contact' 'Here are the Dragons \u003cdragons@wherever.com\u003e'\nset 'service' 'snmp' 'location' 'The Cave'\n\nset 'service' 'ssh' 'port' '22'\n\nset 'system' 'name-server' '8.8.8.8'\nset 'system' 'name-server' '8.8.4.4'\n\nset 'system' 'ntp' 'server' '0.pool.ntp.org'\nset 'system' 'ntp' 'server' '1.pool.ntp.org'\nset 'system' 'ntp' 'server' '2.pool.ntp.org'\n\nset 'system' 'time-zone' 'UTC'\n\ncommit\n\n",
                            "vars.#": "4",
                            "vars.fqdn": "test-vyos-1.1.0-i02",
                            "vars.private_ip_mine": "10.50.11.42",
                            "vars.private_ip_peer": "10.50.11.115",
                            "vars.short_name": "vyos02"
                        }
                    }
                },
                "template_file.010_ipsec_configuration_vyos01": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_instance.vyos01",
                        "aws_instance.vyos02"
                    ],
                    "primary": {
                        "id": "afe83f7b55fb365dfe7374977a8be015e5ce4ac9cedd70b178aa23c51d8ce8e5",
                        "attributes": {
                            "id": "afe83f7b55fb365dfe7374977a8be015e5ce4ac9cedd70b178aa23c51d8ce8e5",
                            "rendered": "#!/bin/vbash\n\nsource /opt/vyatta/etc/functions/script-template\n\nconfigure\n\nset 'interfaces' 'tunnel' 'tun1' 'address' \"192.168.100.13/30\"\nset 'interfaces' 'tunnel' 'tun1' 'description' \"OSPF - GRE tunnel to test-vyos-1.1.0-i01\"\nset 'interfaces' 'tunnel' 'tun1' 'encapsulation' 'gre'\nset 'interfaces' 'tunnel' 'tun1' 'local-ip' \"10.50.11.115\"\nset 'interfaces' 'tunnel' 'tun1' 'mtu' '1280'\nset 'interfaces' 'tunnel' 'tun1' 'multicast' 'enable'\nset 'interfaces' 'tunnel' 'tun1' 'remote-ip' \"10.50.11.42\"\n\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'compression' 'enab;e'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'lifetime' '3600'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'mode' 'tunnel'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'pfs' 'enable'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'proposal' '1' 'encryption' 'aes256'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'proposal' '1' 'hash' 'sha1'\n\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'action' 'restart'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'interval' '15'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'timeout' '30'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'key-exchange' 'ikev1'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'lifetime' '28800'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'dh-group' '2'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'encryption' 'aes256'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'hash' 'sha1'\n\nset 'vpn' 'ipsec' 'ipsec-interfaces' 'interface' 'eth0'\n\nset 'vpn' 'ipsec' 'nat-traversal' 'enable'\n\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'authentication' 'id' \"@Tun1_10.50.11.115\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'authentication' 'mode' 'pre-shared-secret'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'authentication' 'pre-shared-secret' 'password'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'authentication' 'remote-id' \"@Tun1_10.50.11.42\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'connection-type' 'initiate'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'default-esp-group' 'espgroup1'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'description' \"OSPF IPSEC GRE to 10.50.11.42\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'ike-group' 'ikegroup1'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'local-address' \"10.50.11.115\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'tunnel' '1' 'allow-nat-networks' 'disable'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'tunnel' '1' 'allow-public-networks' 'disable'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.42\" 'tunnel' '1' 'protocol' 'gre'\n\n\ncommit\n\n",
                            "template": "#!/bin/vbash\n\nsource /opt/vyatta/etc/functions/script-template\n\nconfigure\n\nset 'interfaces' 'tunnel' 'tun1' 'address' \"${internal_ip_mine_range}\"\nset 'interfaces' 'tunnel' 'tun1' 'description' \"OSPF - GRE tunnel to ${fqdn}\"\nset 'interfaces' 'tunnel' 'tun1' 'encapsulation' 'gre'\nset 'interfaces' 'tunnel' 'tun1' 'local-ip' \"${private_ip_mine}\"\nset 'interfaces' 'tunnel' 'tun1' 'mtu' '1280'\nset 'interfaces' 'tunnel' 'tun1' 'multicast' 'enable'\nset 'interfaces' 'tunnel' 'tun1' 'remote-ip' \"${private_ip_peer}\"\n\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'compression' 'enab;e'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'lifetime' '3600'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'mode' 'tunnel'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'pfs' 'enable'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'proposal' '1' 'encryption' 'aes256'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'proposal' '1' 'hash' 'sha1'\n\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'action' 'restart'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'interval' '15'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'timeout' '30'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'key-exchange' 'ikev1'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'lifetime' '28800'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'dh-group' '2'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'encryption' 'aes256'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'hash' 'sha1'\n\nset 'vpn' 'ipsec' 'ipsec-interfaces' 'interface' 'eth0'\n\nset 'vpn' 'ipsec' 'nat-traversal' 'enable'\n\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'authentication' 'id' \"@Tun1_${private_ip_mine}\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'authentication' 'mode' 'pre-shared-secret'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'authentication' 'pre-shared-secret' 'password'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'authentication' 'remote-id' \"@Tun1_${private_ip_peer}\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'connection-type' 'initiate'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'default-esp-group' 'espgroup1'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'description' \"OSPF IPSEC GRE to ${private_ip_peer}\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'ike-group' 'ikegroup1'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'local-address' \"${private_ip_mine}\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'tunnel' '1' 'allow-nat-networks' 'disable'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'tunnel' '1' 'allow-public-networks' 'disable'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'tunnel' '1' 'protocol' 'gre'\n\n\ncommit\n\n",
                            "vars.#": "5",
                            "vars.fqdn": "test-vyos-1.1.0-i01",
                            "vars.internal_ip_mine_range": "192.168.100.13/30",
                            "vars.private_ip_mine": "10.50.11.115",
                            "vars.private_ip_peer": "10.50.11.42",
                            "vars.short_name": "vyos01"
                        }
                    }
                },
                "template_file.010_ipsec_configuration_vyos02": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_instance.vyos01",
                        "aws_instance.vyos02"
                    ],
                    "primary": {
                        "id": "b8e598755d137947203e101275ff8c97c9f2178a9e289e5eb93c3d9a481b1be7",
                        "attributes": {
                            "id": "b8e598755d137947203e101275ff8c97c9f2178a9e289e5eb93c3d9a481b1be7",
                            "rendered": "#!/bin/vbash\n\nsource /opt/vyatta/etc/functions/script-template\n\nconfigure\n\nset 'interfaces' 'tunnel' 'tun1' 'address' \"192.168.100.14/30\"\nset 'interfaces' 'tunnel' 'tun1' 'description' \"OSPF - GRE tunnel to test-vyos-1.1.0-i02\"\nset 'interfaces' 'tunnel' 'tun1' 'encapsulation' 'gre'\nset 'interfaces' 'tunnel' 'tun1' 'local-ip' \"10.50.11.42\"\nset 'interfaces' 'tunnel' 'tun1' 'mtu' '1280'\nset 'interfaces' 'tunnel' 'tun1' 'multicast' 'enable'\nset 'interfaces' 'tunnel' 'tun1' 'remote-ip' \"10.50.11.115\"\n\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'compression' 'enab;e'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'lifetime' '3600'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'mode' 'tunnel'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'pfs' 'enable'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'proposal' '1' 'encryption' 'aes256'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'proposal' '1' 'hash' 'sha1'\n\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'action' 'restart'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'interval' '15'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'timeout' '30'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'key-exchange' 'ikev1'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'lifetime' '28800'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'dh-group' '2'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'encryption' 'aes256'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'hash' 'sha1'\n\nset 'vpn' 'ipsec' 'ipsec-interfaces' 'interface' 'eth0'\n\nset 'vpn' 'ipsec' 'nat-traversal' 'enable'\n\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'authentication' 'id' \"@Tun1_10.50.11.42\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'authentication' 'mode' 'pre-shared-secret'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'authentication' 'pre-shared-secret' 'password'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'authentication' 'remote-id' \"@Tun1_10.50.11.115\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'connection-type' 'initiate'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'default-esp-group' 'espgroup1'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'description' \"OSPF IPSEC GRE to 10.50.11.115\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'ike-group' 'ikegroup1'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'local-address' \"10.50.11.42\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'tunnel' '1' 'allow-nat-networks' 'disable'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'tunnel' '1' 'allow-public-networks' 'disable'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"10.50.11.115\" 'tunnel' '1' 'protocol' 'gre'\n\n\ncommit\n\n",
                            "template": "#!/bin/vbash\n\nsource /opt/vyatta/etc/functions/script-template\n\nconfigure\n\nset 'interfaces' 'tunnel' 'tun1' 'address' \"${internal_ip_mine_range}\"\nset 'interfaces' 'tunnel' 'tun1' 'description' \"OSPF - GRE tunnel to ${fqdn}\"\nset 'interfaces' 'tunnel' 'tun1' 'encapsulation' 'gre'\nset 'interfaces' 'tunnel' 'tun1' 'local-ip' \"${private_ip_mine}\"\nset 'interfaces' 'tunnel' 'tun1' 'mtu' '1280'\nset 'interfaces' 'tunnel' 'tun1' 'multicast' 'enable'\nset 'interfaces' 'tunnel' 'tun1' 'remote-ip' \"${private_ip_peer}\"\n\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'compression' 'enab;e'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'lifetime' '3600'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'mode' 'tunnel'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'pfs' 'enable'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'proposal' '1' 'encryption' 'aes256'\nset 'vpn' 'ipsec' 'esp-group' 'espgroup1' 'proposal' '1' 'hash' 'sha1'\n\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'action' 'restart'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'interval' '15'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'dead-peer-detection' 'timeout' '30'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'key-exchange' 'ikev1'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'lifetime' '28800'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'dh-group' '2'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'encryption' 'aes256'\nset 'vpn' 'ipsec' 'ike-group' 'ikegroup1' 'proposal' '1' 'hash' 'sha1'\n\nset 'vpn' 'ipsec' 'ipsec-interfaces' 'interface' 'eth0'\n\nset 'vpn' 'ipsec' 'nat-traversal' 'enable'\n\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'authentication' 'id' \"@Tun1_${private_ip_mine}\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'authentication' 'mode' 'pre-shared-secret'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'authentication' 'pre-shared-secret' 'password'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'authentication' 'remote-id' \"@Tun1_${private_ip_peer}\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'connection-type' 'initiate'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'default-esp-group' 'espgroup1'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'description' \"OSPF IPSEC GRE to ${private_ip_peer}\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'ike-group' 'ikegroup1'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'local-address' \"${private_ip_mine}\"\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'tunnel' '1' 'allow-nat-networks' 'disable'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'tunnel' '1' 'allow-public-networks' 'disable'\nset 'vpn' 'ipsec' 'site-to-site' 'peer' \"${private_ip_peer}\" 'tunnel' '1' 'protocol' 'gre'\n\n\ncommit\n\n",
                            "vars.#": "5",
                            "vars.fqdn": "test-vyos-1.1.0-i02",
                            "vars.internal_ip_mine_range": "192.168.100.14/30",
                            "vars.private_ip_mine": "10.50.11.42",
                            "vars.private_ip_peer": "10.50.11.115",
                            "vars.short_name": "vyos02"
                        }
                    }
                }
            }
        }
    ]
}
